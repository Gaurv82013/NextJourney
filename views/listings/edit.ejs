<% layout('/layouts/boilerplate') -%>

    <button class="btn btn-outline-dark" onclick="window.history.back()"><i class="fa-solid fa-arrow-left"></i> Go Back</button>
    
        <div class="row mt-3 g-2">

                <h2 class="col-8 offset-2">Edit your listing</h2><br><br>

            <div class="col-8 offset-2  ">
                <form method="post" action="/listings/<%=editListing.id%>?_method=patch" class="needs-validation" novalidate enctype="multipart/form-data">
                    <label for="title">Title:</label>
                    <input type="text" id="title" name="listing[title]" class="form-control" required value="<%=editListing.title%>"><br>

                <label for="description">Description:</label>
                <textarea id="description" name="listing[description]" class="form-control" required><%=editListing.description%></textarea>
            
                <div>
                    <label>Current Image:</label><br>
                    <% if(editListing.image && editListing.image.url){ %>
                        <img src="<%=editListing.image.url%>" alt="Current Image" style="width: 200px;height: 150px; display: block; margin-bottom: 10px;border-radius: 5px;">
                    <% } %>
                </div>

                <label for="image">Upload new image:</label>
                <input type="file" id="image" name="listing[image]" class="form-control"><br>
                <div class="row">
                    <div class="col-md-4">
                        <label for="price">Price:</label>
                        <input type="number" id="price" name="listing[price]" class="form-control"  required value="<%=editListing.price%>"><br>
                    </div>
                    <div class="col-md-8">
                        <label for="country">Country:</label>
                        <input type="text" id="country" name="listing[country]" class="form-control" required value="<%=editListing.country%>"><br>
                    </div>
                </div>
                <label for="location">Location:</label>
                <input type="text" id="location" name="listing[location]" class="form-control"  required value="<%=editListing.location%>"><br>
                <label for="category">Categories (You can select multiple):</label>
                <div class="category-checkboxes mt-2 mb-3">
                    <div class="row">
                        <div class="col-md-4">
                            <div class="form-check">
                                <input class="form-check-input" type="checkbox" name="listing[category][]" value="Mountain" id="categoryMountain" <%= editListing.category && editListing.category.includes('Mountain') ? 'checked' : '' %>>
                                <label class="form-check-label" for="categoryMountain">Mountain</label>
                            </div>
                            <div class="form-check">
                                <input class="form-check-input" type="checkbox" name="listing[category][]" value="Amazing Pools" id="categoryPools" <%= editListing.category && editListing.category.includes('Amazing Pools') ? 'checked' : '' %>>
                                <label class="form-check-label" for="categoryPools">Amazing Pools</label>
                            </div>
                            <div class="form-check">
                                <input class="form-check-input" type="checkbox" name="listing[category][]" value="Rooms" id="categoryRooms" <%= editListing.category && editListing.category.includes('Rooms') ? 'checked' : '' %>>
                                <label class="form-check-label" for="categoryRooms">Rooms</label>
                            </div>
                            <div class="form-check">
                                <input class="form-check-input" type="checkbox" name="listing[category][]" value="Farms" id="categoryFarms" <%= editListing.category && editListing.category.includes('Farms') ? 'checked' : '' %>>
                                <label class="form-check-label" for="categoryFarms">Farms</label>
                            </div>
                        </div>
                        <div class="col-md-4">
                            <div class="form-check">
                                <input class="form-check-input" type="checkbox" name="listing[category][]" value="Iconic City" id="categoryCity" <%= editListing.category && editListing.category.includes('Iconic City') ? 'checked' : '' %>>
                                <label class="form-check-label" for="categoryCity">Iconic City</label>
                            </div>
                            <div class="form-check">
                                <input class="form-check-input" type="checkbox" name="listing[category][]" value="Castles" id="categoryCastles" <%= editListing.category && editListing.category.includes('Castles') ? 'checked' : '' %>>
                                <label class="form-check-label" for="categoryCastles">Castles</label>
                            </div>
                            <div class="form-check">
                                <input class="form-check-input" type="checkbox" name="listing[category][]" value="Amazing Views" id="categoryViews" <%= editListing.category && editListing.category.includes('Amazing Views') ? 'checked' : '' %>>
                                <label class="form-check-label" for="categoryViews">Amazing Views</label>
                            </div>
                            <div class="form-check">
                                <input class="form-check-input" type="checkbox" name="listing[category][]" value="Cabins" id="categoryCabins" <%= editListing.category && editListing.category.includes('Cabins') ? 'checked' : '' %>>
                                <label class="form-check-label" for="categoryCabins">Cabins</label>
                            </div>
                        </div>
                        <div class="col-md-4">
                            <div class="form-check">
                                <input class="form-check-input" type="checkbox" name="listing[category][]" value="Beach" id="categoryBeach" <%= editListing.category && editListing.category.includes('Beach') ? 'checked' : '' %>>
                                <label class="form-check-label" for="categoryBeach">Beach</label>
                            </div>
                            <div class="form-check">
                                <input class="form-check-input" type="checkbox" name="listing[category][]" value="Desert" id="categoryDesert" <%= editListing.category && editListing.category.includes('Desert') ? 'checked' : '' %>>
                                <label class="form-check-label" for="categoryDesert">Desert</label>
                            </div>
                            <div class="form-check">
                                <input class="form-check-input" type="checkbox" name="listing[category][]" value="Island" id="categoryIsland" <%= editListing.category && editListing.category.includes('Island') ? 'checked' : '' %>>
                                <label class="form-check-label" for="categoryIsland">Island</label>
                            </div>
                            <div class="form-check">
                                <input class="form-check-input" type="checkbox" name="listing[category][]" value="Treehouses" id="categoryTreehouses" <%= editListing.category && editListing.category.includes('Treehouses') ? 'checked' : '' %>>
                                <label class="form-check-label" for="categoryTreehouses">Treehouses</label>
                            </div>
                        </div>
                    </div>
                </div>

                <button class="btn-action" type="submit"><i class="fa-solid fa-floppy-disk"></i> Save Changes</button>
                </form>
            </div>
            
        </div>
        <script src="/js/script.js"></script>
    

